library(tidyverse)
dat <- read.csv('C:\\Users\\Jessie PC\\OneDrive - University of North Carolina at Chapel Hill\\Symbolic_regression_github\\NIH_Cloud_NOSI\\Models\\3_Omic_measurements\\partial_deriv.csv')
dat_sum <- dat %>%
group_by(gene) %>%
mutate(sum_dir = sum(direction)) %>%
select(gene, sum_dir) %>%
unique()
dat_top <- dat_sum %>%
arrange(desc(abs(sum_dir))) %>%
mutate(Association = ifelse(sum_dir > 0, "Positively associated", "Negatively associated"))
dat_top <- dat_top[1:15,]
# Create bar chart
p <- ggplot(dat_top, aes(x = reorder(gene, -sum_dir), y = sum_dir, fill = Association)) +
geom_bar(stat = "identity") +
labs(x = "Gene", y = "Directional importance") +
scale_fill_manual(values = c("Positively associated" = "darkred", "Negatively associated" = "darkblue")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
p
View(dat)
